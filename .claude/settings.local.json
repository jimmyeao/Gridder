{
  "permissions": {
    "allow": [
      "WebSearch",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:pypi.org)",
      "Bash(dotnet restore:*)",
      "Bash(dotnet build:*)",
      "Bash(python -m pip install:*)",
      "Bash(python:*)",
      "Bash(cmd /c \"type %LOCALAPPDATA%\\\\Gridder\\\\analysis.log 2>NUL\")",
      "Bash(findstr:*)",
      "Bash(powershell:*)",
      "WebFetch(domain:www.ee.ic.ac.uk)",
      "WebFetch(domain:web.archive.org)",
      "WebFetch(domain:www.eecs.qmul.ac.uk)",
      "WebFetch(domain:www.semanticscholar.org)",
      "WebFetch(domain:www.audiolabs-erlangen.de)",
      "WebFetch(domain:www-labs.iro.umontreal.ca)",
      "WebFetch(domain:www.researchgate.net)",
      "WebFetch(domain:musicinformationretrieval.com)",
      "WebFetch(domain:www.iro.umontreal.ca)",
      "WebFetch(domain:en.wikipedia.org)",
      "WebFetch(domain:archive.gamedev.net)",
      "WebFetch(domain:www.flipcode.com)",
      "WebFetch(domain:www.parallelcube.com)",
      "WebFetch(domain:madmom.readthedocs.io)",
      "WebFetch(domain:tempobeatdownbeat.github.io)",
      "Bash(pip show:*)",
      "Bash(pip install:*)",
      "Bash(where:*)",
      "Bash(py -3.9:*)",
      "Bash(py:*)",
      "Bash(uv:*)",
      "Bash(pip download:*)",
      "Bash(git clone:*)",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\":*)",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" -c \"import sysconfig; print\\(sysconfig.get_platform\\(\\)\\)\")",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" -c \"from setuptools._distutils.util import get_platform; print\\(''setuptools:'', get_platform\\(\\)\\); import distutils.util; print\\(''stdlib:'', distutils.util.get_platform\\(\\)\\)\")",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" -c:*)",
      "Bash(set \"VSCMD_ARG_TGT_ARCH=x64\")",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" -m pip install:*)",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" -c \"\nfrom madmom.features.beats import RNNBeatProcessor, DBNBeatTrackingProcessor\nprint\\(''madmom imported successfully!''\\)\nprint\\(''RNNBeatProcessor:'', RNNBeatProcessor\\)\nprint\\(''DBNBeatTrackingProcessor:'', DBNBeatTrackingProcessor\\)\n\")",
      "Bash(git submodule update:*)",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" -m gridder_analysis \"C:\\\\Users\\\\jimmy\\\\Music\\\\DJ Library\\\\Tiesto - Red Lights.mp3\")",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" -m gridder_analysis:*)",
      "Bash(winget install:*)",
      "Bash(where.exe:*)",
      "Bash(dir /s /b \"C:\\\\Users\\\\jimmy\\\\AppData\\\\Local\\\\Microsoft\\\\WinGet\\\\Packages\\\\*ffmpeg.exe\")",
      "Bash(cmd /c:*)",
      "Bash(dir:*)",
      "Bash(dotnet run:*)",
      "Bash(python\\\\.venv\\\\Scripts\\\\python.exe:*)",
      "Bash(\"python/.venv/Scripts/python.exe\":*)",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\pip.exe\" install mutagen)",
      "Bash(stat:*)",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" -c \"\nfrom mutagen.mp3 import MP3\nf = MP3\\(r''F:\\\\Onedrive\\\\DJ Music\\\\Trance\\\\Sash! - Encore Une Fois \\(Original 12_\\) - 10A - 133.mp3''\\)\nprint\\(f''Encoder delay: {f.info.encoder_delay} samples''\\)\nprint\\(f''Encoder padding: {f.info.encoder_padding} samples''\\)\nprint\\(f''Sample rate: {f.info.sample_rate} Hz''\\)\nprint\\(f''Delay in ms: {f.info.encoder_delay / f.info.sample_rate * 1000:.2f} ms''\\)\nprint\\(f''Bitrate: {f.info.bitrate}''\\)\nprint\\(f''Encoder info: {f.info.encoder_info!r}''\\)\n\")",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" -c \"\nfrom mutagen.mp3 import MP3\nf = MP3\\(r''F:\\\\Onedrive\\\\DJ Music\\\\Trance\\\\Sash! - Encore Une Fois \\(Original 12_\\) - 10A - 133.mp3''\\)\nprint\\(''MPEGInfo attributes:''\\)\nfor attr in dir\\(f.info\\):\n    if not attr.startswith\\(''_''\\):\n        print\\(f''  {attr} = {getattr\\(f.info, attr, \"\"?\"\"\\)}''\\)\n\")",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" \"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\measure_offset.py\")",
      "Bash(del:*)",
      "WebFetch(domain:raw.githubusercontent.com)",
      "WebFetch(domain:homepage.ruhr-uni-bochum.de)",
      "WebFetch(domain:support.serato.com)",
      "WebFetch(domain:serato.com)",
      "WebFetch(domain:bugs.launchpad.net)",
      "Bash(python\\\\.venv\\\\Scripts\\\\python.exe -c \"\nimport struct, sys\n\nfilepath = r''F:\\\\Onedrive\\\\DJ Music\\\\Trance\\\\Sash! - Encore Une Fois \\(Original 12_\\) - 10A - 133.mp3''\n\nwith open\\(filepath, ''rb''\\) as f:\n    header = f.read\\(10\\)\n    \n    # Check for ID3v2 tag\n    if header[:3] == b''ID3'':\n        id3_size = \\(\\(header[6] & 0x7F\\) << 21 | \\(header[7] & 0x7F\\) << 14 |\n                    \\(header[8] & 0x7F\\) << 7 | \\(header[9] & 0x7F\\)\\)\n        id3_offset = 10 + id3_size\n        print\\(f''ID3v2 tag: {id3_size} bytes \\(ends at offset {id3_offset}\\)''\\)\n        \n        # Seek past ID3v2 and read the first MP3 frame area\n        f.seek\\(id3_offset\\)\n        data = f.read\\(4096\\)\n    else:\n        f.seek\\(0\\)\n        data = f.read\\(4096\\)\n        id3_offset = 0\n    \n    # Find first MPEG frame sync\n    offset = 0\n    while offset < len\\(data\\) - 4:\n        if data[offset] == 0xFF and \\(data[offset + 1] & 0xE0\\) == 0xE0:\n            b1 = data[offset + 1]\n            mpeg_ver = \\(b1 >> 3\\) & 3\n            layer = \\(b1 >> 1\\) & 3\n            if mpeg_ver != 1 and layer != 0:\n                break\n        offset += 1\n    \n    print\\(f''First MPEG frame at offset {offset} \\(absolute: {id3_offset + offset}\\)''\\)\n    \n    # Parse frame header\n    frame_header = struct.unpack\\(''>I'', data[offset:offset + 4]\\)[0]\n    mpeg_version = \\(frame_header >> 19\\) & 3\n    layer_idx = \\(frame_header >> 17\\) & 3\n    bitrate_idx = \\(frame_header >> 12\\) & 0xF\n    sample_rate_idx = \\(frame_header >> 10\\) & 3\n    channel_mode = \\(frame_header >> 6\\) & 3\n    \n    mpeg_names = {3: ''MPEG1'', 2: ''MPEG2'', 0: ''MPEG2.5''}\n    layer_names = {3: ''Layer I'', 2: ''Layer II'', 1: ''Layer III''}\n    sr_table = {3: {0: 44100, 1: 48000, 2: 32000}, 2: {0: 22050, 1: 24000, 2: 16000}}\n    ch_names = {0: ''Stereo'', 1: ''Joint Stereo'', 2: ''Dual Channel'', 3: ''Mono''}\n    \n    print\\(f''MPEG version: {mpeg_names.get\\(mpeg_version, \"\"unknown\"\"\\)} \\({mpeg_version}\\)''\\)\n    print\\(f''Layer: {layer_names.get\\(layer_idx, \"\"unknown\"\"\\)} \\({layer_idx}\\)''\\)\n    print\\(f''Sample rate: {sr_table.get\\(mpeg_version, {}\\).get\\(sample_rate_idx, \"\"?\"\"\\)} Hz''\\)\n    print\\(f''Channel mode: {ch_names.get\\(channel_mode, \"\"unknown\"\"\\)}''\\)\n    \n    # Side info size\n    if mpeg_version == 3:  # MPEG1\n        side_info_size = 32 if channel_mode != 3 else 17\n    else:\n        side_info_size = 17 if channel_mode != 3 else 9\n    \n    print\\(f''Side info size: {side_info_size} bytes''\\)\n    \n    # Xing/Info tag\n    xing_offset = offset + 4 + side_info_size\n    tag = data[xing_offset:xing_offset + 4]\n    print\\(f''Xing tag at offset {xing_offset}: {tag}''\\)\n    \n    if tag in \\(b''Xing'', b''Info''\\):\n        flags = struct.unpack\\(''>I'', data[xing_offset + 4:xing_offset + 8]\\)[0]\n        print\\(f''Xing flags: 0x{flags:08x}''\\)\n        \n        pos = xing_offset + 8\n        if flags & 0x01:\n            frames = struct.unpack\\(''>I'', data[pos:pos+4]\\)[0]\n            print\\(f''  Frames: {frames}''\\)\n            pos += 4\n        if flags & 0x02:\n            bytes_count = struct.unpack\\(''>I'', data[pos:pos+4]\\)[0]\n            print\\(f''  Bytes: {bytes_count}''\\)\n            pos += 4\n        if flags & 0x04:\n            print\\(f''  TOC present \\(100 bytes\\)''\\)\n            pos += 100\n        if flags & 0x08:\n            quality = struct.unpack\\(''>I'', data[pos:pos+4]\\)[0]\n            print\\(f''  Quality: {quality}''\\)\n            pos += 4\n        \n        # Encoder version string \\(9 bytes\\)\n        version = data[pos:pos + 9]\n        print\\(f''Encoder version: {version}''\\)\n        print\\(f''  As text: {version.decode\\(\"\"ascii\"\", errors=\"\"replace\"\"\\)}''\\)\n        \n        # LAME delay/padding at offset +21 from version string\n        delay_offset = pos + 21\n        print\\(f''Delay/padding bytes at offset {delay_offset}: {data[delay_offset]:02x} {data[delay_offset+1]:02x} {data[delay_offset+2]:02x}''\\)\n        \n        b0 = data[delay_offset]\n        b1 = data[delay_offset + 1]\n        b2 = data[delay_offset + 2]\n        \n        encoder_delay = \\(b0 << 4\\) | \\(b1 >> 4\\)\n        encoder_padding = \\(\\(b1 & 0x0F\\) << 8\\) | b2\n        \n        print\\(f''Encoder delay: {encoder_delay} samples \\({encoder_delay/44100*1000:.2f}ms\\)''\\)\n        print\\(f''Encoder padding: {encoder_padding} samples \\({encoder_padding/44100*1000:.2f}ms\\)''\\)\n        \n        # Also dump a few more fields for reference\n        # Method/quality byte at +21-3 = +18? No, let me check the layout\n        # LAME header layout from version string start:\n        # +0: 9 bytes version\n        # +9: 1 byte info tag revision + VBR method\n        # +10: 1 byte lowpass frequency\n        # +11: 4 bytes replay gain peak\n        # +15: 2 bytes radio replay gain\n        # +17: 2 bytes audiophile replay gain\n        # +19: 1 byte encoding flags + ATH type\n        # +20: 1 byte bitrate / min VBR bitrate\n        # +21: 3 bytes encoder delay + padding\n        \n        print\\(f''\\\\nLAME header at version+offset:''\\)\n        for i in range\\(24\\):\n            print\\(f''  +{i:2d}: 0x{data[pos+i]:02x} \\({data[pos+i]:3d}\\) {chr\\(data[pos+i]\\) if 32 <= data[pos+i] < 127 else \"\".\"\"}''\\)\n    else:\n        print\\(''No Xing/Info tag found!''\\)\n        # Look for VBRI tag\n        vbri_offset = offset + 4 + 32\n        vbri_tag = data[vbri_offset:vbri_offset + 4]\n        print\\(f''VBRI tag check at offset {vbri_offset}: {vbri_tag}''\\)\n\")",
      "Bash(python\\\\.venv\\\\Scripts\\\\python.exe pythondebug_lame.py)",
      "Bash(\"C:\\\\Users\\\\jimmy\\\\source\\\\repos\\\\Gridder\\\\python\\\\.venv\\\\Scripts\\\\python.exe\" \"C:\\\\Users\\\\jimmy\\\\AppData\\\\Local\\\\Temp\\\\survey_grids.py\")"
    ]
  }
}
